
from distutils.command.clean import clean
from py2neo import Graph,Node,Relationship
import json
import os
from py2neo.matching import *
import csv

KGraph = Graph(
    "http://nju.csuncle.com:7474", 
    auth=("neo4j","wlm94929")
)


matcher = NodeMatcher(KGraph)
result = matcher.match('CAPEC').all()
labels = ["ID","CAPEC_ID","Pre-Description"]
with open("/media/william/184A50404A501D36/CVE-Analyze/capec-dataset.csv", "w", newline='')as a_test:
    writer = csv.writer(a_test)
    writer.writerow(labels)  #第一行为标签行
    index=0
    for item in result:
        pos=item["Prerequisites"]
        poses=pos.split("::")
        for pos_item in poses:
            pos_item=pos_item.strip()
            if pos_item=="":
                continue
            writer.writerow(["CAPEC-"+str(index),item["name"],pos_item])  #第一行为标签行
            index+=1
                
       
            
        
        