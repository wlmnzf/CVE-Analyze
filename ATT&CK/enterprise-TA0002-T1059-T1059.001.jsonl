{"TTP_id": "enterprise-TA0002-T1059-T1059.001", "TTP_name": "PowerShell", "Description": "Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.[1] Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.A number of PowerShell-based offensive testing tools are available, including Empire, PowerSploit, PoshC2, and PSAttack.[2]PowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI).[3][4][5]", "Property": {"ID": "T1059.001", "Sub-technique of": "T1059", "Tactic": "Execution", "Platforms": "Windows", "Supports Remote": "Yes", "Contributors": "Mayuresh Dani, Qualys; Praetorian", "Version": "1.2", "Created": "09 March 2020", "Last Modified": "19 April 2022"}, "Examples": {"S0677": ["https://attack.mitre.org/software/S0677", "AADInternals", "AADInternals is written and executed via PowerShell.[6]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed has the ability to execute its payload via PowerShell.[7]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 used PowerShell commands to execute payloads.[8]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 downloads and executes PowerShell scripts and performs PowerShell commands.[9][10][11]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used encoded PowerShell scripts uploaded to CozyCar installations to download and install SeaDuke. APT29 also used PowerShell to create new tasks on remote machines, identify configuration settings, evade defenses, exfiltrate data, and to execute other commands.[12][13][14][15][16][17][18][19]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has used PowerShell on victim systems to download and run payloads after exploitation.[20]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used PowerShell-based tools, PowerShell one-liners, and shellcode loaders for execution.[21][22][23]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has utilized PowerShell to download files from the C2 server and run various scripts. [24][25]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used PowerShell to execute commands and other operational tasks.[26]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used PowerShell to execute malicious code.[27][28]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 leveraged PowerShell to deploy malware families in victims’ environments.[29][30]"], "G0143": ["https://attack.mitre.org/groups/G0143", "Aquatic Panda", "Aquatic Panda has downloaded additional scripts and executed Base64 encoded commands in PowerShell.[31]"], "S0129": ["https://attack.mitre.org/software/S0129", "AutoIt backdoor", "AutoIt backdoor downloads a PowerShell script that decodes to a typical shellcode loader.[32]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook has used PowerShell loaders as part of execution.[33]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can execute a PowerShell script received from C2.[34][35]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can use PowerShell to pull Active Directory information from the target environment.[36]"], "G0108": ["https://attack.mitre.org/groups/G0108", "Blue Mockingbird", "Blue Mockingbird has used PowerShell reverse TCP shells to issue interactive commands over a network connection.[37]"], "S0360": ["https://attack.mitre.org/software/S0360", "BONDUPDATER", "BONDUPDATER is written in PowerShell.[38][39]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used PowerShell for execution.[40]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can use PowerShell for payload execution and C2 communication.[41]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used PowerShell scripts to execute malicious payloads and the DSInternals PowerShell module to make use of Active Directory features.[42][43]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "The Clambling dropper can use PowerShell to download the malware.[44]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has used powershell.exe to download and execute scripts.[45][46][47][48][49][50]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can execute a payload on a remote host with PowerShell. This technique does not write any data to disk.[51][52] Cobalt Strike can also use PowerSploit and other scripting frameworks to perform execution.[53][54][55][56]"], "S0126": ["https://attack.mitre.org/software/S0126", "ComRAT", "ComRAT has used PowerShell to load itself every time a user logs in to the system. ComRAT can execute PowerShell scripts loaded into memory or from the file system.[57][58]"], "G0142": ["https://attack.mitre.org/groups/G0142", "Confucius", "Confucius has used PowerShell to execute malicious files and payloads.[59]"], "S0591": ["https://attack.mitre.org/software/S0591", "ConnectWise", "ConnectWise can be used to execute PowerShell commands on target machines.[60]"], "G0052": ["https://attack.mitre.org/groups/G0052", "CopyKittens", "CopyKittens has used PowerShell Empire.[61]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can execute PowerShell commands via WMI.[62]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba has been dropped onto systems and used for lateral movement via obfuscated PowerShell scripts.[63]"], "G0079": ["https://attack.mitre.org/groups/G0079", "DarkHydrus", "DarkHydrus leveraged PowerShell to download and execute additional scripts for execution.[64][65]"], "G0105": ["https://attack.mitre.org/groups/G0105", "DarkVishnya", "DarkVishnya used PowerShell to create shellcode loaders.[66]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can execute PowerShell commands and has used PowerShell to execute a keylogger.[67]"], "G0009": ["https://attack.mitre.org/groups/G0009", "Deep Panda", "Deep Panda has used PowerShell scripts to download and execute programs in memory, without writing to disk.[68]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis has a version written in PowerShell.[23]"], "S0695": ["https://attack.mitre.org/software/S0695", "Donut", "Donut can generate shellcode outputs that execute via PowerShell.[69]"], "S0186": ["https://attack.mitre.org/software/S0186", "DownPaper", "DownPaper uses PowerShell for execution.[70]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used PowerShell scripts for execution.[71][72]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor has used an encoded PowerShell command by a service created by Cobalt Strike for lateral movement.[73]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has used Powershell to retrieve the malicious payload and download additional resources like Mimikatz. [74][75][76][77][78]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire leverages PowerShell for the majority of its client-side agent tasks. Empire also contains the ability to conduct PowerShell remoting with the Invoke-PSRemoting module.[79][80]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke has the ability to execute PowerShell scripts.[81]"], "S0679": ["https://attack.mitre.org/software/S0679", "Ferocious", "Ferocious can use PowerShell scripts for execution.[82]"], "G0051": ["https://attack.mitre.org/groups/G0051", "FIN10", "FIN10 uses PowerShell for execution as well as PowerShell Empire to establish persistence.[83][79]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has used PowerShell to gain access to merchant's networks, and a Metasploit PowerShell module to download and execute shellcode and to set up a local listener.[84][85][86]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 used a PowerShell script to launch shellcode that retrieved an additional payload.[87][88][89]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8's malicious spearphishing payloads are executed as PowerShell. FIN8 has also used PowerShell for lateral movement and credential access.[90][91][92]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used PowerShell scripts to access credential data.[93]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has used PowerShell to run a series of base64-encoded commands, that acted as a stager and enumerated hosts.[94]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used PowerShell for execution to assist in lateral movement as well as for dumping credentials stored on compromised machines.[95]"], "G0084": ["https://attack.mitre.org/groups/G0084", "Gallmaker", "Gallmaker used PowerShell to download additional payloads and for execution.[96]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has used obfuscated PowerShell scripts for staging.[97]"], "G0115": ["https://attack.mitre.org/groups/G0115", "GOLD SOUTHFIELD", "GOLD SOUTHFIELD has staged and executed PowerShell scripts on compromised hosts.[98]"], "G0078": ["https://attack.mitre.org/groups/G0078", "Gorgon Group", "Gorgon Group malware can use PowerShell commands to download and execute a payload and open a decoy document on the victim’s machine.[99]"], "S0417": ["https://attack.mitre.org/software/S0417", "GRIFFON", "GRIFFON has used PowerShell to execute the Meterpreter downloader TinyMet.[100]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has used the Exchange Power Shell module Set-OabVirtualDirectoryPowerShell to export mailbox data.[101][102]"], "S0151": ["https://attack.mitre.org/software/S0151", "HALFBAKED", "HALFBAKED can execute PowerShell scripts.[87]"], "S0037": ["https://attack.mitre.org/software/S0037", "HAMMERTOSS", "HAMMERTOSS is known to use PowerShell.[103]"], "S0499": ["https://attack.mitre.org/software/S0499", "Hancitor", "Hancitor has used PowerShell to execute commands.[104]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "One version of Helminth uses a PowerShell script.[105]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has used PowerShell to execute malicious commands and payloads.[106][107]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has used PowerShell Empire for execution of malware.[108][109]"], "S0389": ["https://attack.mitre.org/software/S0389", "JCry", "JCry has used PowerShell to execute payloads.[110]"], "S0648": ["https://attack.mitre.org/software/S0648", "JSS Loader", "JSS Loader has the ability to download and execute PowerShell scripts.[111]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy uses PowerShell commands to download and execute payloads.[112]"], "S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY can execute PowerShell commands on the victim's machine.[113]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has executed a variety of PowerShell scripts.[114][115][116][117]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic has used PowerShell to establish persistence.[118]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS has used PowerShell commands to download additional files.[118]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI used PowerShell to download and execute a specific 64-bit version of the malware.[119][120]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used PowerShell to execute commands and malicious code.[121][122]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has used PowerShell scripts to execute malicious code.[118]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has used PowerShell for execution.[123][124][125][126]"], "S0680": ["https://attack.mitre.org/software/S0680", "LitePower", "LitePower can use a PowerShell script to execute commands.[82]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar has used PowerShell scripts.[127]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has used PowerShell commands embedded inside batch scripts.[128]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound has used PowerShell for execution and privilege escalation.[129][130]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass uses PowerSploit to inject shellcode into PowerShell.[131][132]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor can use PowerShell commands to disable the network adapters on a victim machines.[133]"], "S0553": ["https://attack.mitre.org/software/S0553", "MoleNet", "MoleNet can use PowerShell to set persistence.[134]"], "G0021": ["https://attack.mitre.org/groups/G0021", "Molerats", "Molerats used PowerShell implants on target machines.[135]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito can launch PowerShell Scripts.[136]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used PowerShell for execution.[137][138][139][140][141][142][143][144]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used malicious PowerShell scripts to enable execution.[145][146]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Netwalker has been written in PowerShell and executed directly in memory, avoiding detection.[147][148]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "The NETWIRE binary has been executed via PowerShell script.[149]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT has executed PowerShell commands via auto-run registry key persistence.[150]"], "G0133": ["https://attack.mitre.org/groups/G0133", "Nomadic Octopus", "Nomadic Octopus has used PowerShell for execution.[151]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents.[38][152][153]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used PowerShell on compromised systems.[154]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D uses PowerShell scripts.[155]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork used PowerSploit to download payloads, run a reverse shell, and execute malware on the victim's machine.[156][157]"], "S0517": ["https://attack.mitre.org/software/S0517", "Pillowmint", "Pillowmint has used a PowerShell script to install a shim database.[158]"], "G0033": ["https://attack.mitre.org/groups/G0033", "Poseidon Group", "The Poseidon Group's Information Gathering Tool (IGT) includes PowerShell components.[159]"], "S0150": ["https://attack.mitre.org/software/S0150", "POSHSPY", "POSHSPY uses PowerShell to execute various commands, one to execute its payload.[160]"], "S0685": ["https://attack.mitre.org/software/S0685", "PowerPunch", "PowerPunch has the ability to execute through PowerShell.[97]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower is a backdoor written in PowerShell.[106]"], "S0145": ["https://attack.mitre.org/software/S0145", "POWERSOURCE", "POWERSOURCE is a PowerShell backdoor.[161][162]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit modules are written in and executed via PowerShell.[163][164]"], "S0393": ["https://attack.mitre.org/software/S0393", "PowerStallion", "PowerStallion uses PowerShell loops to iteratively check for available commands in its OneDrive C2 server.[165]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS uses PowerShell for obfuscation and execution.[166][141][167]"], "S0371": ["https://attack.mitre.org/software/S0371", "POWERTON", "POWERTON is written in PowerShell.[168]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER is written in PowerShell.[38]"], "S0613": ["https://attack.mitre.org/software/S0613", "PS1", "PS1 can utilize a PowerShell loader.[169]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY has used PowerShell scripts.[170]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy has a module for loading and executing PowerShell scripts.[171]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa has used Powershell scripts to deploy its ransomware.[172]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use PowerShell to download and execute payloads.[173]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT uses PowerShell scripts for execution.[174]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "There is a variant of RATANKBA that uses a PowerShell script instead of the traditional PE form.[175][176]"], "S0511": ["https://attack.mitre.org/software/S0511", "RegDuke", "RegDuke can extract and execute PowerShell scripts from C2 communications.[81]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT uses the PowerShell command Reflection.Assembly to load itself into memory to aid in execution.[177]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil has used PowerShell to delete volume shadow copies and download files.[178][179][180][181]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin uses a command prompt to run a PowerShell script from Excel.[64] To assist in establishing persistence, RogueRobin creates %APPDATA%\\OneDrive.bat and saves the following string to it:powershell.exe -WindowStyle Hidden -exec bypass -File \"%APPDATA%\\OneDrive.ps1\".[182][64]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used PowerShell scripts to run a credential harvesting tool in memory to evade defenses.[183][184]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke uses a module to execute Mimikatz with PowerShell to perform Pass the Ticket.[14]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper has the ability to execute a PowerShell script to get information from the infected host.[185]"], "S0546": ["https://attack.mitre.org/software/S0546", "SharpStage", "SharpStage can execute arbitrary commands with PowerShell.[134][186]"], "S0450": ["https://attack.mitre.org/software/S0450", "SHARPSTATS", "SHARPSTATS has the ability to employ a custom PowerShell script.[167]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used PowerShell to drop and execute malware loaders.[187]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used PowerShell to download and execute payloads.[188][189]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can use PowerShell to execute commands.[190]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM can execute Powershell commands sent from its C2 server.[191]"], "S0273": ["https://attack.mitre.org/software/S0273", "Socksbot", "Socksbot can write and execute PowerShell scripts.[157]"], "S0390": ["https://attack.mitre.org/software/S0390", "SQLRat", "SQLRat has used PowerShell to create a Meterpreter session.[192]"], "G0038": ["https://attack.mitre.org/groups/G0038", "Stealth Falcon", "Stealth Falcon malware uses PowerShell commands to perform various functions, including gathering system information via WMI and executing commands from its C2 server.[193]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity can use PowerShell to add files to the Windows Defender exclusions list.[194]"], "G0062": ["https://attack.mitre.org/groups/G0062", "TA459", "TA459 has used PowerShell for execution of a payload.[195]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has used PowerShell to download and execute malware and reconnaissance scripts.[196][197][198][199]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has executed PowerShell commands in batch scripts.[200]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has used a publicly-available PowerShell-based tool, WMImplant.[201] The group has also used PowerShell to perform Timestomping.[202]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used PowerShell for execution.[203][44]"], "G0076": ["https://attack.mitre.org/groups/G0076", "Thrip", "Thrip leveraged PowerShell to run commands to download payloads, traverse the compromised networks, and carry out reconnaissance.[204]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has used PowerShell to download additional payloads.[205]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot has been known to use PowerShell to download new payloads, open documents, and upload data to command and control servers. [206]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used PowerShell to execute commands/scripts, in some cases via a custom executable or code from Empire's PSInject.[207][165][208] Turla has also used PowerShell scripts to load and execute malware in memory."], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif droppers have used PowerShell in download cradles to download and execute the malware's full executable payload.[209]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has used PowerShell to download additional modules.[210]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can use PowerShell to download files and execute commands.[211][212]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can execute PowerShell scripts received from C2.[213][214]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate can use PowerShell to support multiple actions including execution and defense evasion.[215][216][217]"], "G0090": ["https://attack.mitre.org/groups/G0090", "WIRTE", "WIRTE has used PowerShell for script execution.[218]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used macros to execute PowerShell scripts to download malware on victim's machines.[219] It has also used PowerShell to execute commands and move laterally through a victim network.[220][221][222]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash can use scripts to invoke PowerShell to download a malicious PE executable or PE DLL for execution.[223]"], "S0330": ["https://attack.mitre.org/software/S0330", "Zeus Panda", "Zeus Panda uses PowerShell to download and execute the payload.[224]"]}, "Mitigation": {"M1049": ["https://attack.mitre.org/mitigations/M1049", "Antivirus/Antimalware", "Anti-virus can be used to automatically quarantine suspicious files."], "M1045": ["https://attack.mitre.org/mitigations/M1045", "Code Signing", "Set PowerShell execution policy to execute only signed scripts."], "M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution."], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use application control where appropriate."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.[225]"]}, "Detection": {"Command Execution": ["If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity. It is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). [226] PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features.[227] An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Module Load": ["Monitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations).[3][4]", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Process Creation": ["Monitor for newly executed processes that may abuse PowerShell commands and scripts for execution.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Metadata": ["Consider monitoring for Windows event ID (EID) 400, which shows the version of PowerShell executing in the EngineVersion field (which may also be relevant to detecting a potential Downgrade Attack) as well as if PowerShell is running locally or remotely in the HostName field. Furthermore, EID 400 may indicate the start time and EID 403 indicates the end time of a PowerShell session.[228]", "", "", ""], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
