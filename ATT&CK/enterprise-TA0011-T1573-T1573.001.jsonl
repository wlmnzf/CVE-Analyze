{"TTP_id": "enterprise-TA0011-T1573-T1573.001", "TTP_name": "Symmetric Cryptography", "Description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.", "Property": {"ID": "T1573.001", "Sub-technique of": "T1573", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "16 March 2020", "Last Modified": "26 March 2020"}, "Examples": {"S0066": ["https://attack.mitre.org/software/S0066", "3PARA RAT", "3PARA RAT command and control commands are encrypted within the HTTP C2 channel using the DES algorithm in CBC mode with a key derived from the MD5 hash of the string HYF54&%9&jkMCXuiS. 3PARA RAT will use an 8-byte XOR key derived from the string HYF54&%9&jkMCXuiS if the DES decoding fails[1]"], "S0065": ["https://attack.mitre.org/software/S0065", "4H RAT", "4H RAT obfuscates C2 communication using a 1-byte XOR with the key 0xBE.[1]"], "S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "A variant of ADVSTORESHELL encrypts some C2 with 3DES.[2]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 installed a Delphi backdoor that used a custom algorithm for C2 communications.[3]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used AES for encryption of command and control traffic.[4]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor has encrypted data symmetrically using a randomly generated Blowfish (OFB) key which is encrypted with a public RSA key.[5]"], "S0344": ["https://attack.mitre.org/software/S0344", "Azorult", "Azorult can encrypt C2 traffic using XOR.[6][7]"], "S0245": ["https://attack.mitre.org/software/S0245", "BADCALL", "BADCALL encrypts C2 traffic using an XOR/ADD cipher.[8]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS encrypts C2 data with a ROR by 3 and an XOR by 0x23.[9][10]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook has used AES encryption for C2 communication.[11]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can send C2 communications with XOR encryption.[12]"], "S0127": ["https://attack.mitre.org/software/S0127", "BBSRAT", "BBSRAT uses a custom encryption algorithm on data sent back to the C2 server over HTTP.[13]"], "S0574": ["https://attack.mitre.org/software/S0574", "BendyBear", "BendyBear communicates to a C2 server over port 443 using modified RC4 and XOR-encrypted chunks.[14]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal variants reported on in 2014 and 2015 used a simple XOR cipher for C2. Some Bisonal samples encrypt C2 communications with RC4.[15][16][17]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has encrypted its C2 traffic with RC4.[18]"], "S0486": ["https://attack.mitre.org/software/S0486", "Bonadan", "Bonadan can XOR-encrypt C2 communications.[19]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used RC4 encryption (for Datper malware) and AES (for xxmm malware) to obfuscate HTTP traffic. BRONZE BUTLER has also used a tool called RarStar that encodes data with a custom XOR algorithm when posting it to a C2 server.[20]"], "S0077": ["https://attack.mitre.org/software/S0077", "CallMe", "CallMe uses AES to encrypt C2 traffic.[21]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak encrypts the message body of HTTP traffic with RC2 (in CBC mode). Carbanak also uses XOR with random keys for its communications.[22][23]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT uses a secret key with a series of XOR and addition operations to encrypt C2 traffic.[24]"], "S0220": ["https://attack.mitre.org/software/S0220", "Chaos", "Chaos provides a reverse shell connection on 8338/TCP, encrypted via AES.[25]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can send additional modules over C2 encrypted with a simple substitution cipher.[26]"], "S0144": ["https://attack.mitre.org/software/S0144", "ChChes", "ChChes can encrypt C2 traffic with AES or RC4.[27][28]"], "S0023": ["https://attack.mitre.org/software/S0023", "CHOPSTICK", "CHOPSTICK encrypts C2 communications with RC4.[29]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike has the ability to use AES-256 symmetric encryption in CBC mode with HMAC-SHA-256 to encrypt task commands and XOR to encrypt shell code and configuration data.[30]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie encrypts command and control communications with RC4.[31]"], "S0137": ["https://attack.mitre.org/software/S0137", "CORESHELL", "CORESHELL C2 messages are encrypted with custom stream ciphers using six-byte or eight-byte keys.[32]"], "S0050": ["https://attack.mitre.org/software/S0050", "CosmicDuke", "CosmicDuke contains a custom version of the RC4 algorithm that includes a programming error.[33]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has used AES-256 and 3DES for C2 communications.[34]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "Daserf uses RC4 encryption to obfuscate HTTP traffic.[20]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "Derusbi obfuscates C2 traffic with variable 4-byte XOR keys.[35]"], "S0200": ["https://attack.mitre.org/software/S0200", "Dipsind", "Dipsind encrypts C2 data with AES256 in ECB mode.[36]"], "S0472": ["https://attack.mitre.org/software/S0472", "down_new", "down_new has the ability to AES encrypt C2 communications.[37]"], "S0134": ["https://attack.mitre.org/software/S0134", "Downdelph", "Downdelph uses RC4 to encrypt C2 responses.[38]"], "S0384": ["https://attack.mitre.org/software/S0384", "Dridex", "Dridex has encrypted traffic with RC4.[39]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "The Duqu command and control protocol's data stream can be encrypted with AES-CBC.[40]"], "S0377": ["https://attack.mitre.org/software/S0377", "Ebury", "Ebury has encrypted C2 traffic using the client IP address, then encoded it as a hexadecimal string.[41]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise encrypts exfiltrated data with RC4.[42]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "The C2 server response to a beacon sent by a variant of Emissary contains a 36-character GUID value that is used as an encryption key for subsequent network communications. Some variants of Emissary use various XOR operations to encrypt C2 data.[43]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic encrypts commands from the C2 server using a hardcoded key.[44]"], "S0569": ["https://attack.mitre.org/software/S0569", "Explosive", "Explosive has encrypted communications with the RC4 method.[45]"], "S0076": ["https://attack.mitre.org/software/S0076", "FakeM", "The original variant of FakeM encrypts C2 traffic using a custom encryption cipher that uses an XOR key of \"YHCRA\" and bit rotation between each XOR operation. Some variants of FakeM use RC4 to encrypt C2 traffic.[21]"], "S0181": ["https://attack.mitre.org/software/S0181", "FALLCHILL", "FALLCHILL encrypts C2 data with RC4 encryption.[46][47]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke can AES encrypt C2 communications.[48]"], "S0171": ["https://attack.mitre.org/software/S0171", "Felismus", "Some Felismus samples use a custom encryption method for C2 traffic that utilizes AES and multiple keys.[49]"], "S0381": ["https://attack.mitre.org/software/S0381", "FlawedAmmyy", "FlawedAmmyy has used SEAL encryption during the initial C2 handshake.[50]"], "S0661": ["https://attack.mitre.org/software/S0661", "FoggyWeb", "FoggyWeb has used a dynamic XOR key and custom XOR methodology for C2 communications.[51]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has communicated with a C2 via an encrypted RC4 byte stream and AES-CBC.[52]"], "S0168": ["https://attack.mitre.org/software/S0168", "Gazer", "Gazer uses custom encryption for C2 that uses 3DES.[53][54]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "gh0st RAT uses RC4 and XOR to encrypt C2 traffic.[55]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy encrypts communications using AES256.[56]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can use an AES key to encrypt C2 communications.[57]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 encrypts C2 traffic using an RC4 key.[58]"], "S0037": ["https://attack.mitre.org/software/S0037", "HAMMERTOSS", "Before being appended to image files, HAMMERTOSS commands are encrypted with a key composed of both a hard-coded value and a string contained on that day's tweet. To decrypt the commands, an investigator would need access to the intended malware sample, the day's tweet, and the image file containing the command.[59]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth encrypts data sent to its C2 server over HTTP with RC4.[60]"], "S0087": ["https://attack.mitre.org/software/S0087", "Hi-Zor", "Hi-Zor encrypts C2 traffic with a double XOR using two distinct single-byte keys.[61]"], "S0394": ["https://attack.mitre.org/software/S0394", "HiddenWasp", "HiddenWasp uses an RC4-like algorithm with an already computed PRGA generated key-stream for network communication.[62]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa used AES-128 to encrypt C2 traffic.[63]"], "S0009": ["https://attack.mitre.org/software/S0009", "Hikit", "Hikit performs XOR encryption.[64]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has compressed network communications and encrypted them with a custom stream cipher.[65][66]"], "S0068": ["https://attack.mitre.org/software/S0068", "httpclient", "httpclient encrypts C2 content with XOR using a single byte, 0x12.[1]"], "S0203": ["https://attack.mitre.org/software/S0203", "Hydraq", "Hydraq C2 traffic is encrypted using bitwise NOT and XOR operations.[67]"], "S0537": ["https://attack.mitre.org/software/S0537", "HyperStack", "HyperStack has used RSA encryption for C2 communications.[68]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has encrypted network communications with AES.[69]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole uses variations of a simple XOR encryption routine for C&C communications.[70]"], "S0271": ["https://attack.mitre.org/software/S0271", "KEYMARBLE", "KEYMARBLE uses a customized XOR algorithm to encrypt C2 communications.[71]"], "S0641": ["https://attack.mitre.org/software/S0641", "Kobalos", "Kobalos's post-authentication communication channel uses a 32-byte-long password with RC4 for inbound and outbound traffic.[72][73]"], "S0162": ["https://attack.mitre.org/software/S0162", "Komplex", "The Komplex C2 channel uses an 11-byte XOR algorithm to hide data.[74]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has used AES to encrypt C2 traffic.[75]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Several Lazarus Group malware families encrypt C2 traffic using custom code that uses XOR with an ADD operation and XOR with a SUB operation. Another Lazarus Group malware sample XORs C2 traffic. Other Lazarus Group malware uses Caracachs encryption to encrypt C2 payloads. Lazarus Group has also used AES to encrypt C2 traffic.[76][77][78][79][80]"], "S0395": ["https://attack.mitre.org/software/S0395", "LightNeuron", "LightNeuron uses AES to encrypt C2 traffic.[81]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack uses a modified version of RC4 for data transfer.[82]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can perform a decremental-xor encryption on the initial C2 request before sending it over the wire.[83]"], "S0010": ["https://attack.mitre.org/software/S0010", "Lurid", "Lurid performs XOR encryption.[84]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete has used AES to exfiltrate documents.[85]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has encrypted C2 commands with AES-256.[86]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind encrypts C2 traffic using RC4 with a static key.[87]"], "S0284": ["https://attack.mitre.org/software/S0284", "More_eggs", "More_eggs has used an RC4-based encryption method for its C2 communications.[88]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito uses a custom encryption algorithm, which consists of XOR and a stream that is similar to the Blum Blum Shub algorithm.[89]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has encrypted C2 communications with RC4.[90]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore uses DES to encrypt the C2 traffic.[91]"], "S0272": ["https://attack.mitre.org/software/S0272", "NDiskMonitor", "NDiskMonitor uses AES to encrypt certain information sent over its C2 channel.[10]"], "S0630": ["https://attack.mitre.org/software/S0630", "Nebulae", "Nebulae can use RC4 and XOR to encrypt C2 communications.[92]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "NETEAGLE will decrypt resources it downloads with HTTP requests by using RC4 with the key \"ScoutEagle.\"[93]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can use AES encryption for C2 data transferred.[94]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum uses AES to encrypt network traffic. The key can be hardcoded or negotiated with the C2 server in the registration phase. [95]"], "S0664": ["https://attack.mitre.org/software/S0664", "Pandora", "Pandora has the ability to encrypt communications with D3DES.[96]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "PipeMon communications are RC4 encrypted.[97]"], "S0254": ["https://attack.mitre.org/software/S0254", "PLAINTEE", "PLAINTEE encodes C2 beacons using XOR.[98]"], "S0435": ["https://attack.mitre.org/software/S0435", "PLEAD", "PLEAD has used RC4 encryption to download modules.[99]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX can use RC4 encryption in C2 communications.[100]"], "S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy uses the Camellia cipher to encrypt communications.[101]"], "S0371": ["https://attack.mitre.org/software/S0371", "POWERTON", "POWERTON has used AES for encrypting C2 traffic.[4]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "Prikormka encrypts some C2 traffic with the Blowfish cipher.[102]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can RC4 encrypt strings in C2 communication.[103]"], "S0262": ["https://attack.mitre.org/software/S0262", "QuasarRAT", "QuasarRAT uses AES to encrypt network communication.[104][105]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use RC4 to encrypt C2 communications.[92]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT has used AES ciphertext to encode C2 communications.[106]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves has encrypted C2 traffic with RC4, previously using keys of 88888888 and babybear.[107]"], "S0433": ["https://attack.mitre.org/software/S0433", "Rifdoor", "Rifdoor has encrypted command and control (C2) communications with a stream cipher.[65]"], "S0003": ["https://attack.mitre.org/software/S0003", "RIPTIDE", "APT12 has used the RIPTIDE RAT, which communicates over HTTP with a payload encrypted with RC4.[108]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM encrypts C2 traffic with a custom RC4 variant.[109]"], "S0074": ["https://attack.mitre.org/software/S0074", "Sakula", "Sakula encodes C2 traffic with single-byte XOR keys.[110]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke C2 traffic has been encrypted with RC4 and AES.[111][112]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist can encrypt C2 communications with a randomly generated key.[113]"], "S0633": ["https://attack.mitre.org/software/S0633", "Sliver", "Sliver can use AES-GCM-256 to encrypt a session key for C2 message exchange.[114]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has encrypted its C2 traffic with RC4.[115]"], "S0159": ["https://attack.mitre.org/software/S0159", "SNUGRIDE", "SNUGRIDE encrypts C2 traffic using AES with a static key.[116]"], "S0627": ["https://attack.mitre.org/software/S0627", "SodaMaster", "SodaMaster can use RC4 to encrypt C2 communications.[117]"], "G0038": ["https://attack.mitre.org/groups/G0038", "Stealth Falcon", "Stealth Falcon malware encrypts C2 traffic using RC4 with a hard-coded key.[118]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet encodes the payload of system information sent to the command and control servers using a one byte 0xFF XOR key. Stuxnet also uses a 31-byte long static byte string to XOR data sent to command and control servers. The servers use a different static key to encrypt replies to the implant.[119]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST encrypted C2 traffic using a single-byte-XOR cipher.[120]"], "S0060": ["https://attack.mitre.org/software/S0060", "Sys10", "Sys10 uses an XOR 0x1 loop to encrypt its C2 domain.[121]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor uses RC4 to encrypt the message body of HTTP content.[122][123]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE uses a Linear Feedback Shift Register (LFSR) algorithm for network encryption.[124]"], "S0678": ["https://attack.mitre.org/software/S0678", "Torisma", "Torisma has encrypted its C2 communications using XOR and VEST-32.[125]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot uses a custom crypter leveraging Microsoftâ€™s CryptoAPI to encrypt C2 traffic.[126]Newer versions of TrickBot have been known to use bcrypt to encrypt and digitally sign responses to their C2 server. [127]"], "S0436": ["https://attack.mitre.org/software/S0436", "TSCookie", "TSCookie has encrypted network communications with RC4.[128]"], "S0275": ["https://attack.mitre.org/software/S0275", "UPPERCUT", "Some versions of UPPERCUT have used the hard-coded string \"this is the encrypt key\" for Blowfish encryption when communicating with a C2. Later versions have hard-coded keys uniquely for each C2 address.[129]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Volgmer uses a simple XOR cipher to encrypt traffic and files.[130]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can encrypt its C2 with RC4 with the password warzone160\\x00.[131]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can encrypt HTTP POST data using RC6 and a dynamically generated AES key encrypted with a hard coded RSA public key.[132][133][134]"], "S0430": ["https://attack.mitre.org/software/S0430", "Winnti for Linux", "Winnti for Linux has used a custom TCP protocol with four-byte XOR for command and control (C2).[135]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "Winnti for Windows can XOR encrypt C2 traffic.[136]"], "S0653": ["https://attack.mitre.org/software/S0653", "xCaon", "xCaon has encrypted data sent to the C2 server using a XOR key.[137]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET uses RC4 encryption over TCP to communicate with its C2 server.[138]"], "S0230": ["https://attack.mitre.org/software/S0230", "ZeroT", "ZeroT has used RC4 to encrypt C2 traffic.[139][140]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used AES encrypted communications in C2.[141]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"]}}
